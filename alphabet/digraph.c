#include <stdbool.h>

#include "alphabet.h"
#include "../distance/distance.h"

// Digraph/digram/bigraph/bigram frequencies counted in strings with whitespace and
// punctuation removed. Sourced from practicalcryptography.com, see digraphData.
static const double enDigraphFreqs[alphabetSize][alphabetSize] = {
	{
		0.0003980323980731017576538410818187685435987077653408050537,
		0.002029445518441609034449024662194460688624531030654907227,
		0.004140646019086559152799775773701185244135558605194091797,
		0.003440516636743538338161219058974893414415419101715087891,
		0.0001887000148325399602640406460096755836275406181812286377,
		0.001318778519961754259331998540005770337302237749099731445,
		0.002037235297266898250562183747547351231332868337631225586,
		0.000514617062301116830365377285971817400422878563404083252,
		0.003231846814847664194070286924898027791641652584075927734,
		0.0002012572289530234926225454872295017594296950846910476685,
		0.001188057132369201495877830687675213994225487112998962402,
		0.008836830184180957323270000358661491191014647483825683594,
		0.003694613422011018381840852242703476804308593273162841797,
		0.01613624307994741477467748325125285191461443901062011719,
		0.0001733450111315925430861828449025097143021412193775177002,
		0.00197818177120313897290881932633510587038472294807434082,
		7.286278455427353851776156590247524036385584622621536255e-05,
		0.009794636726918317867762731054881442105397582054138183594,
		0.008735606073905992363659578359147417359054088592529296875,
		0.011164000013278052581000565623980946838855743408203125,
		0.001129515154540851893175124054380376037443056702613830566,
		0.001916891724802739956079467020799711463041603565216064453,
		0.0009063006657509357910651459633299964480102062225341796875,
		0.0001528229539840998273299288445770116595667786896228790283,
		0.002664910994887670445813165898130137065891176462173461914,
		0.0001776910897880364386021423417361120300483889877796173096,
	},
	{
		0.002050693502311955185302139170744339935481548309326171875,
		0.00015937502659062185994542915068450383841991424560546875,
		7.409124035287035722491949529810995045409072190523147583e-05,
		3.27816389990014342447656459089699865216971375048160553e-05,
		0.004502292583201862423425421155798176187090575695037841797,
		1.742594151654125461540015273875781076640123501420021057e-05,
		9.369750590351755178660300704684971151436911895871162415e-06,
		3.572720404168359248624903257152141122787725180387496948e-05,
		0.00100747759888303355449434839385958184720948338508605957,
		6.535606858619134840963221799725602068065200001001358032e-05,
		6.242414791326017601278200452874500570032978430390357971e-06,
		0.001605189335488634407370089896005538321333006024360656738,
		4.43573835394313163585713888359407519601518288254737854e-05,
		2.454252101394708359023699717482713822391815483570098877e-05,
		0.001889952188662200960669879101772039575735107064247131348,
		2.663219093038549027782808942266257190567557699978351593e-05,
		1.274939159951851712679988734566727259789331583306193352e-06,
		0.001068673290997696877918654578820678580086678266525268555,
		0.0003260014575526295988947000914492946321843191981315612793,
		9.904332371985113026187363960417542330105789005756378174e-05,
		0.001876279142608692227303657240611300949240103363990783691,
		2.776999261131476895003017402174805283721070736646652222e-05,
		3.242017883085255615122771688518810151435900479555130005e-05,
		6.986379833510873249655809269498263347486499696969985962e-07,
		0.001209972071533815460298022514962212881073355674743652344,
		1.880610420592863920997267999923874270962187438271939754e-06,
	},
	{
		0.004609196220200799734567631560366862686350941658020019531,
		6.892788707439312053705526839308959097252227365970611572e-05,
		0.0006999080660404498636581460679906285804463550448417663574,
		8.289185884225321835228755817936985295091290026903152466e-05,
		0.004579794915992477927213499810932262334972620010375976562,
		6.189224875347616066419836888812255892844405025243759155e-05,
		4.199459496746902784861804613925073681457433849573135376e-05,
		0.004655909917018074065109267678508331300690770149230957031,
		0.001953245644810951749809069255547910870518535375595092773,
		9.603323699648212840467888240514326980701298452913761139e-06,
		0.001666252977855368737347685481609005364589393138885498047,
		0.001314300622817885823290229296844700002111494541168212891,
		6.612709110737392272615087218667895285761915147304534912e-05,
		4.348761278293232593892062021190270115766907110810279846e-05,
		0.006183235459547944436187183470110539929009974002838134766,
		8.85549660704231683151788079300104072899557650089263916e-05,
		3.643416740318781906491155120342284590151393786072731018e-05,
		0.001275250667851081853507166918859638826688751578330993652,
		0.0003195113627612476063337421106069768939050845801830291748,
		0.002749398782469780061488151545745495241135358810424804688,
		0.001064733768307731453725550885280881630023941397666931152,
		2.179028975282120317476242110643624982913024723529815674e-05,
		5.949245850083325324892530305831428449891973286867141724e-05,
		1.225680672545767207061266634848806234003859572112560272e-06,
		0.0002648663556900807364118122233520580266485922038555145264,
		1.339322084336142753386526133008160854842572007328271866e-05,
	},
	{
		0.004066497426128633761732711349168312153778970241546630859,
		0.001412242915276983945896405181485988578060641884803771973,
		0.0008747384633908652975392561401690727507229894399642944336,
		0.0009253368741585970896554314002457886090269312262535095215,
		0.006250933272000210733088110259814129676669836044311523438,
		0.000932876660378787587145354986972733968286775052547454834,
		0.0005647702965981599067951668402542964031454175710678100586,
		0.001060506326289969774787080858402532612672075629234313965,
		0.005012339706678417376728429388776930863969027996063232422,
		0.0001848617842434376913607341208489742712117731571197509766,
		0.0001215838225484720477604511090774508375034201890230178833,
		0.0007055630791509709138359385249827937514055520296096801758,
		0.0008197965178322364236326857955816649337066337466239929199,
		0.0006569005500643486459427800028265664877835661172866821289,
		0.003034212281693778219537893647839155164547264575958251953,
		0.0007273242300802560669423235673036742809927091002464294434,
		6.551933850219462506913464805435864946048241108655929565e-05,
		0.001318619412734827692906813823014999798033386468887329102,
		0.002412020926931387511393811706739143119193613529205322266,
		0.00364458992485686182963289247993543540360406041145324707,
		0.001355489737449038336117301817296265653567388653755187988,
		0.0002864311664512543867920635332069423384382389485836029053,
		0.001134752279920186145145688527691163471899926662445068359,
		6.33954420311266340356615503481840789845591643825173378e-06,
		0.0005129450488553610569553153908373133162967860698699951172,
		2.267231731604564775976740076401938495109789073467254639e-05,
	},
	{
		0.01002047370982647386816744017323799198493361473083496094,
		0.002252199336307051519279198714684753213077783584594726562,
		0.005960924043027139400396929858061412232927978038787841797,
		0.01078783075201661216524495756630130927078425884246826172,
		0.004277843394579735128435693525261740433052182197570800781,
		0.003064716698507391565847735037664278934244066476821899414,
		0.00191633161186143701794348803701950600952841341495513916,
		0.001748130759386468504115730304704356967704370617866516113,
		0.003706392444534687465734767997105336689855903387069702148,
		0.0002906928350236455535146595785533918387955054640769958496,
		0.0005577168512184153999211577712458165478892624378204345703,
		0.005340324916836536837949633849120800732634961605072021484,
		0.004196289840275598849450577887409963295795023441314697266,
		0.01132974719180288719622140547471644822508096694946289062,
		0.003127610073983782927597996348367814789526164531707763672,
		0.003243284496867054368662852681381991715170443058013916016,
		0.0003379724262948294289353456942848197286366485059261322021,
		0.01783813607663436301420389895611151587218046188354492188,
		0.01319814173877954625868635929464289802126586437225341797,
		0.007602122951633151839989643860917567508295178413391113281,
		0.0008496811564944489357162349385532706946833059191703796387,
		0.002445351115846479232718291285664236056618392467498779297,
		0.003417199102620624342335764467293302004691213369369506836,
		0.001306474536093428940458638365385013457853347063064575195,
		0.001741008167115952205011852882421408139634877443313598633,
		0.0001076439018730543590099402173621001566061750054359436035,
	},
	{
		0.001932858875058447549466489334690777468495070934295654297,
		0.0002053951731556388424215775501124880975112318992614746094,
		0.0003632619187375166506723256354405293677700683474540710449,
		0.000172989101215545784933497186486306418373715132474899292,
		0.001972487675067398880945912509332629269920289516448974609,
		0.001407340192586800870291896536912190640578046441078186035,
		0.0001474882366719704413025177069940241381118539720773696899,
		0.0003486492612552242976661776019398075732169672846794128418,
		0.002773699867517286001689091889943483693059533834457397461,
		6.24091159804836720413970252430146956612588837742805481e-05,
		5.293668572624317907168375874071841735712951049208641052e-05,
		0.0006685368848568930093267947967206055182032287120819091797,
		0.00028937904409897906169227277395350483857328072190284729,
		0.0001235768255741323019825106399594005779363214969635009766,
		0.004376321055106180760163603338241955498233437538146972656,
		0.0002774767597265426601407800610843423783080652356147766113,
		1.098579899407813654013937182396531966332986485213041306e-05,
		0.00192856829892302443323071070579999286564998328685760498,
		0.0004734864565775404911252000061949729570187628269195556641,
		0.003167361904580997394864638749822915997356176376342773438,
		0.0007259035968026243202180780578203211916843429207801818848,
		5.658597648337000804354829375242275091295596212148666382e-05,
		0.0002326256350105292158327030538345070453942753374576568604,
		4.466334118655924745940489356543778853847470600157976151e-06,
		0.0001826867792009295742884644742076716283918358385562896729,
		7.212090085662697700017061130939310942267184145748615265e-06,
	},
	{
		0.002599319040587140094283880031866829085629433393478393555,
		0.0002738996222467430380342889861822186503559350967407226562,
		0.000300532506958641300928020134719531597511377185583114624,
		0.0002034611415585633152625089081766418530605733394622802734,
		0.003335938092854369690226645772668234712909907102584838867,
		0.0003388637042782240214704170266912797160330228507518768311,
		0.000339556560748968715504614301892161165596917271614074707,
		0.002284946054969910506776686887064897746313363313674926758,
		0.001642675738186177456998104950969263882143422961235046387,
		4.092085244621808674987673004608268456649966537952423096e-05,
		3.788740841191944166760005585636861269449582323431968689e-05,
		0.0005959090609749415025017671432294719124911352992057800293,
		0.0002725430481287895645090002538779572205385193228721618652,
		0.0005611371940763308164071276884499184234300628304481506348,
		0.00189372474126809514118063848542306004674173891544342041,
		0.0002810286898113785979125278657875242060981690883636474609,
		1.381781512917162095196738774705025321054563391953706741e-05,
		0.001616502368096231793612171934171328757656738162040710449,
		0.0009066972775157312435662104732614352542441338300704956055,
		0.00169929987265274935921699483998281721142120659351348877,
		0.000871489022045593463364210329302750324131920933723449707,
		4.319414320303410710676431105703443336096825078129768372e-05,
		0.0003626143893256056436463774517164893040899187326431274414,
		3.417567731864405219938249022582077429888158803805708885e-06,
		0.0002265899671100061953284143800857464157161302864551544189,
		6.594162018296227302939071374110469037077564280480146408e-06,
	},
	{
		0.008318866088601774635979957395193196134641766548156738281,
		0.0002344990763554902007351904424936606119445059448480606079,
		0.0003332595684786388121230438219555480827693827450275421143,
		0.0001916582992029560990419195798395435303973499685525894165,
		0.02328544973433540124507779012219543801620602607727050781,
		0.0001929369385309759961279890694285654717532452195882797241,
		9.935113145101309739017081401613040725351311266422271729e-05,
		0.0003075760081367028974004551589160882940632291138172149658,
		0.006358586655553939530338691810129603254608809947967529297,
		4.391775732084461896908428313324179725896101444959640503e-05,
		4.865374118746061243281561536910828635882353410124778748e-05,
		0.000270451759388821359568477742385539386305026710033416748,
		0.0003128956935160557726802177391789427929325029253959655762,
		0.0003200548249462442998436451091492926934733986854553222656,
		0.004562544501198665877761406761692342115566134452819824219,
		0.0002263228612275929225484960571890269420691765844821929932,
		2.341304471117094755986363929789462190456106327474117279e-05,
		0.0008887343491083124274662607966490668331971392035484313965,
		0.0005693693742462575899804244627944171952549368143081665039,
		0.001931383895562315987023960239810094208223745226860046387,
		0.0006410148035061384412525153919659715029411017894744873047,
		4.568296874981477663285253654201767403719713911414146423e-05,
		0.0003245100585606960279065613672599965866538695991039276123,
		1.74046655501498932391271547842626077340355550404638052e-06,
		0.000334506987638584453101375792982707935152575373649597168,
		8.571901850675737237982530769553335403543314896523952484e-06,
	},
	{
		0.00231307033867374223223833951124106533825397491455078125,
		0.000600917469715568598395694088765139895258471369743347168,
		0.004964795784650871332543964342676190426573157310485839844,
		0.00298251746487537871058148830627487768651917576789855957,
		0.002892038873930571560300073485905159031972289085388183594,
		0.001327531036266252437855195367433225328568369150161743164,
		0.002204045349069283423609766359163586457725614309310913086,
		0.0001412268585192956048181972539268258515221532434225082397,
		0.0001404038023846559144012374753529570625687483698129653931,
		5.067565177615261965641396679771446542872581630945205688e-05,
		0.0005978370797989063494676242882519545673858374357223510742,
		0.004134382790849850698722267594575896509923040866851806641,
		0.002438508348786110058181719750791671685874462127685546875,
		0.02027553391247904554517411668257409473881125450134277344,
		0.004905072296906288521756156484343591728247702121734619141,
		0.0007744037810152602828786538857741561514558270573616027832,
		6.744365715809147790709560110755660389258991926908493042e-05,
		0.002701435585148021911033877628938171255867928266525268555,
		0.008637575439934269336261785099395638098940253257751464844,
		0.008773684503494425315772708984241035068407654762268066406,
		0.0001333640013746623933718615795385176170384511351585388184,
		0.002111230795771007213296188709250600368250161409378051758,
		0.0002132358292918636825247213906209253764245659112930297852,
		0.0002033612370207256306656184996484171279007568955421447754,
		2.274701445891966157444169516210763504204805940389633179e-05,
		0.000431486311357969323006938955344935493485536426305770874,
	},
	{
		0.000396094435047453946076301267709141029627062380313873291,
		4.481828572440937300674912435738406202290207147598266602e-06,
		5.728322690369556877143259604467928625126660335808992386e-06,
		5.065298824673573718877384736147817534401838202029466629e-06,
		0.0003439648484810569413656911041954344909754581749439239502,
		2.923132773769527947935620987296445605352346319705247879e-06,
		2.78044504264486037759386387324678224786111968569457531e-06,
		4.847220169162128611804220279513089053580188192427158356e-06,
		8.26934373296033605089949691802075903979130089282989502e-05,
		3.719825210924276547822149574518135750622604973614215851e-06,
		3.230015462914477486017434185172625404902646550908684731e-06,
		2.809583866180853694763776620679784912226750748232007027e-06,
		5.165897144024027543539063361821561670694791246205568314e-06,
		3.342176807477627683206841679997012306557735428214073181e-06,
		0.0006293396169488793805840698425413393124472349882125854492,
		7.983112606845261852140348268758174299364327453076839447e-06,
		1.669700840713290473835253612325257854820392822148278356e-07,
		1.860976403781706406252195729056353457053774036467075348e-05,
		9.094550590289592778038552101094182944507338106632232666e-06,
		4.719564370813965436363916078343905269321112427860498428e-06,
		0.0006763941917494241482661232467421541514340788125991821289,
		2.064000000466220969278429916982098291100555798038840294e-06,
		3.719362689915768811505653035354157509573269635438919067e-06,
		1.727515966776769954193733805358768051974038826301693916e-07,
		1.323503865845174613823966025538680924000800587236881256e-06,
		6.611737816619525306372439320268252771484185359440743923e-07,
	},
	{
		0.0006551697964505123544451392625376229261746630072593688965,
		0.0001058849344776990566334776144863383251504274085164070129,
		9.713334321521802572005355180806418502470478415489196777e-05,
		6.428625749351273238694354228428551323304418474435806274e-05,
		0.002463079314842080320968609186138564837165176868438720703,
		0.0001242659818768089747837574110533864768513012677431106567,
		4.839496068320047551846244116013906477746786549687385559e-05,
		0.0001503412975129510319519110517205717769684270024299621582,
		0.001344631131732299976141997710499254026217386126518249512,
		1.776450689476899213797497778521972122689476236701011658e-05,
		2.747629177091229032048498581719542244172771461308002472e-05,
		0.0001957178460946293731357453760111297924595419317483901978,
		0.0001123040322942750566127118050374633639876265078783035278,
		0.0004402820733767629011838617980600929513457231223583221436,
		0.0004065561977388926716801831329206606824300251901149749756,
		8.687370220449717919241477970260234542365651577711105347e-05,
		3.215677311650734695590726081038113193244498688727617264e-06,
		0.0001172537008668216750766413736251081445516319945454597473,
		0.0007463546569753110298400811117858211218845099210739135742,
		0.0003339366992350942600631391599108610535040497779846191406,
		0.0001171607341441116014423007296585410585976205766201019287,
		1.692456874331876002810065573456199672364164143800735474e-05,
		0.0001664226904577600040218560151217275233648251742124557495,
		1.175497143122667017051314643227843959039091714657843113e-06,
		0.0001279555119616760056142773516185684457013849169015884399,
		2.588267563609854009958662762747039209898503031581640244e-06,
	},
	{
		0.005360229277177167711565530794359801802784204483032226562,
		0.0005697548855068488432573658997171150986105203628540039062,
		0.000538389023314889852457609809022187619120813906192779541,
		0.00236939776591335625813283805030096118571236729621887207,
		0.007026448490998915379079914345084034721367061138153076172,
		0.0006249866004773078605530334250772739324020221829414367676,
		0.0002142563818971362187004725541328298277221620082855224609,
		0.0002946369829236961329979593848804597655544057488441467285,
		0.005386327487603231010948601209520347765646874904632568359,
		5.049850622989411429554842958289384569070534780621528625e-05,
		0.000269230241405352165376396733620367740513756871223449707,
		0.005697536135740754147105402438455712399445474147796630859,
		0.0005125921453258695846891268566025701147736981511116027832,
		0.0001739809775182908245169666194840374373598024249076843262,
		0.003606810515100429114648816764088223862927407026290893555,
		0.0005883167786202852947777253156402821332449093461036682129,
		1.784128538218129330717234837244689060753444209694862366e-05,
		0.000348068334868538485984967856268212926806882023811340332,
		0.002006289404150664399534287340998162108007818460464477539,
		0.001576565991616622622664700692496353440219536423683166504,
		0.001018226124599747300231156188488057523500174283981323242,
		0.0002863668760310717690924231515481324095162563025951385498,
		0.000424781838079144003980647248397417570231482386589050293,
		3.57690621929535510932214419088648327260671067051589489e-06,
		0.003177989018532977657377491809143066348042339086532592773,
		1.325446454080907614573019842607592977401509415358304977e-05,
	},
	{
		0.00504804170332513735264257093149353750050067901611328125,
		0.000953201221055647511352926226635418061050586402416229248,
		0.0002547859415701566893758256426849584386218339204788208008,
		0.000111265441369670710250287803955160370605881325900554657,
		0.006299011868313592228674213657768632401712238788604736328,
		0.0001653713802054217110043543570441215706523507833480834961,
		6.59400013594325001874477121255324618687154725193977356e-05,
		0.0001643947670959574182489998372957984429376665502786636353,
		0.002814196125677694091532510256570276396814733743667602539,
		3.104972908264384037204872135440325564559316262602806091e-05,
		2.567939765285934678980608869558466267335461452603340149e-05,
		0.0001106646265796190371083485004533031315077096223831176758,
		0.0008627191612032763861836470731248027732362970709800720215,
		0.0001291351717938752437404847928092976871994324028491973877,
		0.002995001138155509341765014852398962830193340778350830078,
		0.001811965827636181827070549488212236610706895589828491211,
		4.939261849855187620544818422052557593815436121076345444e-06,
		0.000152775083059719272386006716502038216276559978723526001,
		0.0009072014254150048218408586286898298567393794655799865723,
		0.0007067196129327447820869800843013308622175827622413635254,
		0.0008685760647340111471198520476377780141774564981460571289,
		3.152404437686862645560254003740396910870913416147232056e-05,
		0.0002168347052590631767084172754067594723892398178577423096,
		3.295462185618336150845324172831141140704858116805553436e-06,
		0.0004507565553959355869953484763357209885725751519203186035,
		4.225360673223341609003062685490093031148717273026704788e-06,
	},
	{
		0.005445612274171244583664819316481953137554228305816650391,
		0.0008331603685915575565473778496539125626441091299057006836,
		0.003518541387013263913724481213307626603636890649795532227,
		0.01068291849921980569970703101034814608283340930938720703,
		0.006320736942604213842722415961361548397690057754516601562,
		0.001144816505804812419716531834978923143353313207626342773,
		0.008919108277644921187188309374960226705297827720642089844,
		0.0009054796909608343880027092609452665783464908599853515625,
		0.004035982371331825122040548592394770821556448936462402344,
		0.0003105215731793850488656749675442370062228292226791381836,
		0.0007037719665455243432672371994840432307682931423187255859,
		0.0008540415733021566608434982370567922771442681550979614258,
		0.0008780794838958216668931000548070642253151163458824157715,
		0.001198137315228621361043459536688260413939133286476135254,
		0.004369461637289504853109978199654506170190870761871337891,
		0.0006864103154491656318125780700256655109114944934844970703,
		5.028112135589543418108179895220644084474770352244377136e-05,
		0.0005535405177720939063137906011036193376639857888221740723,
		0.004927333664306274806088392637093420489691197872161865234,
		0.01172515825206027137439512841865507652983069419860839844,
		0.0008632034206991841436551471389293510583229362964630126953,
		0.0005075090394423683801128355241871759062632918357849121094,
		0.0009749866543378792960519718668876976153114810585975646973,
		1.730846118038026248595571965349648735355003736913204193e-05,
		0.00100443143552100106440094773319060550420545041561126709,
		6.16219052240033388122622537430572720040800049901008606e-05,
	},
	{
		0.001515732453451620973666758018794098461512476205825805664,
		0.001436708657803518768975026276280004822183400392532348633,
		0.001768437975525509421245717867066105100093409419059753418,
		0.001759941927120229005279683498486065218457952141761779785,
		0.0006050487073635605868651698990845488879131153225898742676,
		0.007062904859410511562711754152132925810292363166809082031,
		0.0009627666180325980711807165590698787127621471881866455078,
		0.0007526740815145536219604727179444125795271247625350952148,
		0.001234148507169528612148479140842027845792472362518310547,
		0.0001528821566731888446834947137276117246074136346578598022,
		0.0007857237514379852936358128445704096520785242319107055664,
		0.003174395230296871844855033373278274666517972946166992188,
		0.004871769859251707732172853582142124650999903678894042969,
		0.01316224987725883414924066272533309529535472393035888672,
		0.002351654766245483193370935381949493603315204381942749023,
		0.002418858837521167294559720772895161644555628299713134766,
		2.837034488035793943785066451024334810426807962357997894e-05,
		0.01057443072776672807200348813694290583953261375427246094,
		0.003144279099869901235309033182829807628877460956573486328,
		0.004645572109956915690665013585203269030898809432983398438,
		0.007195042486331115587361306751290612737648189067840576172,
		0.001699767943913359398433460256683247280307114124298095703,
		0.00337881517790607167547878297853003459749743342399597168,
		0.0001503373660843787204283855674091796572611201554536819458,
		0.000447001578588364703852747750190133046999108046293258667,
		5.285597581025855960269732580769641572260297834873199463e-05,
	},
	{
		0.002791015729033802499764460591791248589288443326950073242,
		8.541282959912518317566881842495263299497310072183609009e-05,
		9.25754299368775361491618047793394907785113900899887085e-05,
		6.317158186300884730682986267780165690055582672357559204e-05,
		0.003601493373586622890464292723322614619974046945571899414,
		9.670574254285252608666356710642730831750668585300445557e-05,
		4.882672404464254308463500020565106751746498048305511475e-05,
		0.0006533904781307826913419600778354379144730046391487121582,
		0.001285625707853425272672587276190370175754651427268981934,
		1.087918790161708044929734368055918025675055105239152908e-05,
		1.919855328164753944836413979135869567471672780811786652e-05,
		0.002269180332613408151987144378836092073470354080200195312,
		0.0002153555630738550937669506524230200739111751317977905273,
		3.044428908250707970254908540930216531705809757113456726e-05,
		0.002756055153563720643700163392963986552786082029342651367,
		0.001127023322607515788684739987957073026336729526519775391,
		4.303064202652658250833426351045218893887067679315805435e-06,
		0.003050599401025211061116992894426402926910668611526489258,
		0.0005497145439897170712470475528732549719279631972312927246,
		0.0008816748909554573488192574792776667891303077340126037598,
		0.0008922372519662465214715374450804574735229834914207458496,
		1.112478655713474094939973574325264848994265776127576828e-05,
		0.0001226631153218250749187268056061839160975068807601928711,
		1.575809075986199619856162855435766090295146568678319454e-06,
		9.161315497867699168994815028810307921958155930042266846e-05,
		2.242533109750246150961667732093296478979027597233653069e-06,
	},
	{
		1.700389109627785459407170454149138549837516620755195618e-05,
		6.315030589661748296594154933325526712906139437109231949e-06,
		2.466855798876546968856956348892239816450455691665410995e-06,
		2.006878655915503252213372142875869030831381678581237793e-06,
		1.39218823560858849165851585522046818255148536991328001e-06,
		2.030004706340895150235882626876815493233152665197849274e-06,
		5.936457144198084171104090774051531553823224385268986225e-07,
		2.838260168708339699133666456098978869704296812415122986e-06,
		1.697151462568230627565336876561019607834168709814548492e-05,
		3.103515967087584074884844959063556757428159471601247787e-07,
		4.678400001056768222108014736171366365624635363928973675e-07,
		2.220794622350377885405120492734454273886512964963912964e-06,
		2.847973109887004279362461914293369602546590613201260567e-06,
		8.806400001989210584181348197285732481986997299827635288e-07,
		2.172461176961308852419391471344489730199711630120873451e-06,
		1.401901176787253071887311313414858915393779170699417591e-06,
		5.779200001305418883386193218409943028746056370437145233e-07,
		1.381781512917162095196738774705025321054563391953706741e-06,
		4.821087732181435580691535036645944956035236828029155731e-06,
		3.911540168950774755624380518703731013374635949730873108e-06,
		0.0009642230966883892293028956999023648677393794059753417969,
		9.740692439175040172620514272727731963641417678445577621e-07,
		8.017570421979094136949971216576926735797314904630184174e-06,
		1.769142857542475222403486907057912347340788983274251223e-07,
		1.05385411788510589603312314621597067798575153574347496e-06,
		6.47529411910971397624839840032051618834429973503574729e-08,
	},
	{
		0.006624590581664445421150588799719116650521755218505859375,
		0.0007738466744605126306291720261754107923479750752449035645,
		0.001612825326078594486908790450740980304544791579246520996,
		0.002087273363832822543201261922263256565202027559280395508,
		0.01408922245696401891190685518040481838397681713104248047,
		0.0007946647450534502976279838115658549213549122214317321777,
		0.001074421964612440804839876840048873418709263205528259277,
		0.0006865444465416328584037031212972124194493517279624938965,
		0.006390801475057014333081006896009057527408003807067871094,
		0.0001198292491026975697260281705780471384059637784957885742,
		0.001038683428806048926126837095296195911942049860954284668,
		0.001110801092015616282904222344996014726348221302032470703,
		0.001706237456519862699319545207288228994002565741539001465,
		0.001633771052469880444985017575731944816652685403823852539,
		0.006759922609930308322334635562356197624467313289642333984,
		0.0008298061662378587548249964100932629662565886974334716797,
		3.629240471408016484962041903195029135531513020396232605e-05,
		0.001363560960308004329361031281564464734401553869247436523,
		0.004911339225311065620482864346740825567394495010375976562,
		0.00496193902364182315434248948804452084004878997802734375,
		0.001232747299774254214066449009123971336521208286285400391,
		0.000622656188375941116973366629139263750403188169002532959,
		0.0007742613245446399068694365297460535657592117786407470703,
		8.939143531430959494377824769983931219030637294054031372e-06,
		0.002032441960795227080954772347354264638852328062057495117,
		2.623234151853046498782326412246845848130760714411735535e-05,
	},
	{
		0.006956346263083920504477486446148759569041430950164794922,
		0.001284347762306918246458242727214837941573932766914367676,
		0.002497760527623023741466967706514878955204039812088012695,
		0.0008885606724696176869290886735086587577825412154197692871,
		0.007292169122991709953596206617021380225196480751037597656,
		0.001404675146535778714265707556307916092919185757637023926,
		0.0004726432807790306896145171577927612815983593463897705078,
		0.003878961807935012509607197728200844721868634223937988281,
		0.005957002558656505908363243406711262650787830352783203125,
		0.0001629096121376387364294846538115280054626055061817169189,
		0.000536960989701121900637137418499378327396698296070098877,
		0.001148211178746755571286608521575089980615302920341491699,
		0.001290608215417576084410589132289715053047984838485717773,
		0.0009615788640827499468219374811894795129774138331413269043,
		0.005527965758559594613985588296145579079166054725646972656,
		0.002444568299039579818698886271022274740971624851226806641,
		0.0001850884195376065329777942602973439534252975136041641235,
		0.0008126050099314522431187546303021917992737144231796264648,
		0.004374453395273826192268806778429279802367091178894042969,
		0.01249232219172935823281456180211534956470131874084472656,
		0.002319775274473576294476107051423241500742733478546142578,
		0.0002039909593738090500328330456625280930893495678901672363,
		0.002005776468352229308100831417505105491727590560913085938,
		1.178850420434348655917330267461906601056398358196020126e-05,
		0.0005120731967543238130624594361961499089375138282775878906,
		1.846383865963283852631646175801449771824991330504417419e-05,
	},
	{
		0.006046905542206225218915260910534925642423331737518310547,
		0.0008823649723001510472575326105015847133472561836242675781,
		0.001201818519935335134035669923946443304885178804397583008,
		0.0005426564733998874090828423710775041399756446480751037598,
		0.009781351042209434493157615975178487133234739303588867188,
		0.0007789899080751197697758403393208936904557049274444580078,
		0.000353838978231186466853752659034171301755122840404510498,
		0.02705698040006127361167820311038667568936944007873535156,
		0.00991845452593788368123028931222506798803806304931640625,
		0.0001293840080964524567007367661375383249833248555660247803,
		0.0001411459173428067424924808870301262686552945524454116821,
		0.001249532187173003471708510048188145447056740522384643555,
		0.0008695073507846416173416859152212055050767958164215087891,
		0.0004121337385804886717897976833313578026718460023403167725,
		0.010664621630644244287822175465407781302928924560546875,
		0.0007100684962948457202777663432868848758516833186149597168,
		3.679609009234520320070008225776803101325640454888343811e-05,
		0.003658824702675203370538792313482190365903079509735107422,
		0.004376031979475863108175470728156142286024987697601318359,
		0.004478931340843644338944873339869445771910250186920166016,
		0.001960509768510071589020515858692306210286915302276611328,
		0.0001614545210448730761052665849675236131588462740182876587,
		0.002060589833070493055028338247325336851645261049270629883,
		6.511370757773324714594298523451243454474024474620819092e-06,
		0.001852146415208283164108293838978624989977106451988220215,
		6.475456001462691281618522243235247515258379280567169189e-05,
	},
	{
		0.001061485020743972327791904142202383809490129351615905762,
		0.0006916696418369082822313886893539347511250525712966918945,
		0.00132798685072013688060477143437765334965661168098449707,
		0.0008093042287542360959523568553208860976155847311019897461,
		0.001139614069501116181901134716270007629645988345146179199,
		0.0001623198978517912489591412672496062441496178507804870605,
		0.001117525916218815949104703477701150404755026102066040039,
		7.847617077402890936772827945588915099506266415119171143e-05,
		0.0008051292828709401272480050693047815002501010894775390625,
		2.038977613905947267654988896978807133564259856939315796e-05,
		0.0001190697896067276938996196133935256966651650145649909973,
		0.002352721339691101962166008831900398945435881614685058594,
		0.001015168860733510394073197957709453476127237081527709961,
		0.003523877954409427269710786134737645625136792659759521484,
		0.0001502975892776470517170350760238761722575873136520385742,
		0.001227287470529323486212458504951428039930760860443115234,
		5.408258152482133889425979650367182216541550587862730026e-06,
		0.004010454218048747562774813957275910070165991783142089844,
		0.003630640291240265493666328211475047282874584197998046875,
		0.003500629335916780830034733540401248319540172815322875977,
		1.457935596967977396850365406910654542116390075534582138e-05,
		4.903902118754763640555427439693403357523493468761444092e-05,
		8.157298018649312618382624107127298884734045714139938354e-05,
		3.34897586630269293171864586344810277296346612274646759e-05,
		0.0001230213378429144107165105204160227003740146756172180176,
		3.555306488198038656440777560696631098835496231913566589e-05,
	},
	{
		0.0009507986556769534728164594561405920103425160050392150879,
		6.750956640180383795549288322712655485702271107584238052e-06,
		1.364992000308327539962946484131123270344687625765800476e-05,
		1.979844302968220389393402824929069083736976608633995056e-05,
		0.006780783001195524878346176933519018348306417465209960938,
		6.496107564492566028018123713838605226555955596268177032e-06,
		5.916800001336500930730014774505676200533343944698572159e-06,
		6.984761009981095325515124128124000435491325333714485168e-06,
		0.002169232086540411226505131736530529451556503772735595703,
		2.643770084630794649915982649779344626495003467425704002e-06,
		2.652326723288189465837063132913620222552708582952618599e-06,
		1.133916504457812331890798063227521197404712438583374023e-05,
		8.099667900989235120819999258490184956826851703226566315e-06,
		7.650560001728126595745872740028659109157160855829715729e-06,
		0.0005210974441513202028153362022067085490562021732330322266,
		1.44715885746974476898374373234901213436387479305267334e-05,
		3.441156303298304642519019232171917366258639958687126637e-07,
		2.229721277814579059785987658059980276448186486959457397e-05,
		4.719865009469495888486112455950660660164430737495422363e-05,
		1.454906084362251131054249997376359715417493134737014771e-05,
		1.91553075673520550913433990736223222484113648533821106e-05,
		5.163815799485742730114828935583659585972782224416732788e-06,
		1.054732907801270764441056021487597149643988814204931259e-05,
		7.381835295785073562346259752608990112321407650597393513e-07,
		5.390266085251179219769296357966936739103402942419052124e-05,
		6.089089077005669978074654802302489997600787319242954254e-07,
	},
	{
		0.003894147991467854577618545874884148361161351203918457031,
		9.130627228953203664615217993727469547593500465154647827e-05,
		0.0001036958225444314544505877706548346850468078628182411194,
		0.000100053932123440756036050758304156715894350782036781311,
		0.003049196574806406576790829277001648733858019113540649414,
		7.775278791672264036213824134335936832940205931663513184e-05,
		3.235103194008063517235138095706759031600086018443107605e-05,
		0.002741109712215806983731658519332086143549531698226928711,
		0.003518170213903936381638626329504404566250741481781005859,
		2.299538824048836849244306645978497272153617814183235168e-05,
		3.44494897556806939321535909748206449876306578516960144e-05,
		0.0001521189970091509069665541842297784569382201880216598511,
		0.0001169454306146512086823571752169925730413524433970451355,
		0.0008440118052326641643473559284416296577546745538711547852,
		0.002106007777282432880117113427331787534058094024658203125,
		7.440714220168121058578830639973489269323181360960006714e-05,
		3.756826891604903499954871623489616183633188484236598015e-06,
		0.0002836999798960156160022860749592155116260983049869537354,
		0.0004599140088433822590174848699007270624861121177673339844,
		0.000300937675362094138927643305336800949589814990758895874,
		4.183132505146576474164277215095353312790393829345703125e-05,
		1.478448403695299991761607366624886594763665925711393356e-05,
		0.000156010648774735857530898686107434514269698411226272583,
		1.081836638899830084170031359314112506808669422753155231e-06,
		0.0001280366843986691311255143865821537474403157830238342285,
		1.221888000276002922233047759403845589076809119433164597e-05,
	},
	{
		0.0002090937224001717580166431753596611997636500746011734009,
		2.174796908054273429037467346702783288492355495691299438e-05,
		0.0001614186756667137189174415778936122478626202791929244995,
		1.389898756616474646320442271063555494947650004178285599e-05,
		0.0001512321129753371252209953601308711768069770187139511108,
		2.613960605632464437460792117118302257949835620820522308e-05,
		9.085993951632197115084524363659568280127132311463356018e-06,
		3.852776874819854066415991677985175556386820971965789795e-05,
		0.000236980964087143259298728903416986213414929807186126709,
		2.458067899714897861261153969025805565706832567229866982e-06,
		3.156937143570239054384983165557621020980150206014513969e-06,
		1.377965714596972508255989797731899670907296240329742432e-05,
		2.948386420834055602420605002311759790245559997856616974e-05,
		8.032602354755599802400845010907914911513216793537139893e-06,
		4.883597446481269781096493098893063233845168724656105042e-05,
		0.0004256802851381704571112618573636154906125739216804504395,
		1.252506891039221630890459872886832926042188773863017559e-06,
		2.082408336604833025136433721780093719644355587661266327e-05,
		3.569436505007953473744830574787556543014943599700927734e-05,
		0.0003491961923477848034336190607973549049347639083862304688,
		3.411855597409333659989980058746539270941866561770439148e-05,
		7.196133110869176561933194258280366284452611580491065979e-06,
		2.759446588858604490143711096550305228447541594505310059e-05,
		8.106143195108345123316845315386558468162547796964645386e-06,
		2.181457210576786187247733117544612468918785452842712402e-05,
		4.81484369856658008162764769005681486646608391311019659e-07,
	},
	{
		0.001674221521050446104608711017647237895289435982704162598,
		0.0006236600902249074627331504316885002481285482645034790039,
		0.0007233951141129820253117266304343502270057797431945800781,
		0.0004908127248167482633428582161627673485781997442245483398,
		0.001503032551600012693693297904928840580396354198455810547,
		0.0005331118898683197228002828005344326811609789729118347168,
		0.0002426112323237091515128194263439809219562448561191558838,
		0.0005298809493633881845253696951658639591187238693237304688,
		0.001031702599224639969530126215602194861276075243949890137,
		8.757349649036953839927044374036313456599600613117218018e-05,
		9.064324842383606026414988310335729693179018795490264893e-05,
		0.0004657445486766320467963975460179426590912044048309326172,
		0.0005819145628205198974777778708755704428767785429954528809,
		0.0003435733244473550621056467946345946984365582466125488281,
		0.00210181039913022406004361464226803946075960993766784668,
		0.0005970829392945343778303923798489449836779385805130004883,
		2.034005513064488001109819670375600253464654088020324707e-05,
		0.00046759463271066337153314407260040752589702606201171875,
		0.001743616554343431967674660221234717027982696890830993652,
		0.001552717945896950075407305646990607783664017915725708008,
		0.0001608444558346512414607337726479840966931078583002090454,
		9.516069111393209156712913454612134955823421478271484375e-05,
		0.0007814440445462623573841254298599778849165886640548706055,
		3.918709244582646362595971384346071886284335050731897354e-06,
		7.70035038829399516753515531064522292581386864185333252e-05,
		1.810330353350098268167510384696328173959045670926570892e-05,
	},
	{
		0.0002148685284518963406995284426415082634775899350643157959,
		1.171380706146947105043311376793013778296881355345249176e-05,
		9.490237313068046747129014040211814062786288559436798096e-06,
		7.60985815297943648253175749629484414526814362034201622e-06,
		0.0003954256296691515933441896102351620356785133481025695801,
		6.627463530908791941023347482619954007532214745879173279e-06,
		6.098108236671572530312231824600743834707827772945165634e-06,
		2.489264941738751621479013020898918284729006700217723846e-05,
		0.0001489398588571722893691973155227969982661306858062744141,
		1.657444033987832655651457544609961303194722859188914299e-06,
		5.610842354208566441764721027807283348920464050024747849e-06,
		1.850985949997936930123618171073474059085128828883171082e-05,
		1.06458460528248775026809516686121526163333328440785408e-05,
		5.605985883619234363408560112285172749579942319542169571e-06,
		9.805815397172943845543330310121632464870344847440719604e-05,
		7.027775463772324120311722067677706604627019260078668594e-06,
		1.335066891057870562835221267539154155201686080545186996e-06,
		7.558749581539320608130575612770840621124079916626214981e-06,
		2.196812908059246421087207234990046345046721398830413818e-05,
		1.317144201978191968922717730583471507088688667863607407e-05,
		2.625685513198138009479526422396133966685738414525985718e-05,
		3.316044370496935075610630064280037743174034403637051582e-06,
		1.592575462544608576515893505476384461871930398046970367e-05,
		5.695946219774008346966687015011654438012556056492030621e-07,
		2.448378084586658921958067514079715465413755737245082855e-05,
		5.117216807878578385942319739498884700878988951444625854e-05,
	},
};

double
digraphFreqScore(const double freqs[][alphabetSize], distanceFunc f) {
	return f(freqs, enDigraphFreqs, alphabetSize);
}

bool
seemsLikeAPlaintextByDigraphCount(const double freqs[][alphabetSize], distanceFunc f) {
	// Closer to natural than a null string.
	return digraphFreqScore(freqs, f) < 0.0006103515625;
}
